# 通知機能 設計書

## 1. 機能概要
取引先ポータル上でのアクション（帳票公開等）に関連して、自動的に関係者へメール通知を行う機能。

- **自動メール通知**: 特定のステータス変化をトリガーとして送信。

## 2. 画面設計
- **通知設定画面**: 
  - メールの送信元・送信先設定。
  - 通知のON/OFF切り替え。
  - メールテンプレートの簡易プレビュー。

## 3. 入出力仕様
### 送信メール項目
- 件名: 【EDIシステム】注文書が発行されました
- 本文: プロジェクト名、注文番号、ログインURL、確認期限等。

## 4. 業務ロジック
- **通知トリガー**: 
  - 注文書PDF生成・公開完了時。
  - 請求明細公開時。
- **送信処理**: Djangoの `send_mail` を使用。バックグラウンド処理（Celery/Redis等）の利用を推奨。

## 5. エラーハンドリング
- 送信失敗時のリトライロジック。
- 送信不可（バウンス等）の記録。

## 6. セキュリティ要件
- 誤送信防止のためのドメイン制限。
- 個人情報の記載最小限化。